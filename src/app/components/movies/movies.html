<div class="container mt-4">
  <!-- Search Section -->
  <div class="mb-4">
    <input
      type="text"
      class="form-control"
      placeholder="Search for a movie..."
      [(ngModel)]="searchTerm"
      (keyup.enter)="onSearch()"
    />
  </div>
  <!-- Loader -->
  @if (loading) {
    <div class="loader-overlay d-flex flex-column justify-content-center align-items-center">
      <div class="loading-dots">
        <span></span><span></span><span></span>
      </div>
      <p class="mt-3 text-light fs-5">Fetching movies...</p>
    </div>
  }

  <!-- Movie Cards -->
  <div class="row">
    @for (movie of movies; track movie.id) {
      <div class="col-md-6 col-lg-3 mb-4">
        <a class="text-decoration-none" [routerLink]="['/movies', movie.id]">
          <div class="card h-100 shadow-sm border-0 movie-card position-relative">

            <!-- Rating Badge Overlay -->
            <div class="rating-overlay position-absolute top-0 start-0 w-100 p-2 d-flex justify-content-between align-items-center">
              <div class="stars text-warning">
                @for (star of [1,2,3,4,5]; track star) {
                  <i
                    class="bi"
                    [ngClass]="{
                      'bi-star-fill': star <= getStars(movie.vote_average),
                      'bi-star': star > getStars(movie.vote_average)
                    }"
                  ></i>
                }
              </div>
              <span class="badge bg-dark bg-opacity-75 fs-6">
                {{ movie.vote_average.toFixed(1) }}
              </span>
            </div>

            <!-- Movie Poster -->
            <img
              [src]="'https://image.tmdb.org/t/p/w500' + movie.poster_path"
              class="card-img-top rounded-top"
              alt="{{ movie.title }}"
            />

            <!-- Movie Title -->
            <div class="card-body text-center">
              <h5 class="card-title fw-bold fs-5 text-dark">{{ movie.title }}</h5>
            </div>
          </div>
        </a>
      </div>
    }
  </div>


  <!-- Pagination -->
@if (total_pages > 1) {
  <nav>
    <ul class="pagination justify-content-center">

      <!-- Previous -->
      <li class="page-item" [class.disabled]="currentPage === 1">
        <button class="page-link" (click)="changePage(currentPage - 1)">Previous</button>
      </li>

      <!-- Page numbers -->
      @for (page of visiblePages; track page) {
        <li class="page-item" [class.active]="currentPage === page">
          <button class="page-link" (click)="changePage(page)">
            {{ page }}
          </button>
        </li>
      }

      <!-- Next -->
      <li class="page-item" [class.disabled]="currentPage === total_pages">
        <button class="page-link" (click)="changePage(currentPage + 1)">Next</button>
      </li>
    </ul>
  </nav>
}
</div>
